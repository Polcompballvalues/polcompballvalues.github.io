var e,t,r,n,a,o,s,c,l,d,i,m,u,h,E,p,g,v,w,b,y,f,j,x,I,O,k,B,F,S,C,L,M,R,T,V;import{getJson as H,Canvas as A}from"./common.js";if(R=!0,F=(e,t)=>{var r;return r=document.getElementById("span-"+e),document.getElementById("bar-"+e).style.width=t.toFixed(1)+"%",r.innerHTML=t.toFixed(1)+"%",r.style.display=t<20?"none":"block"},w=(e,t,r)=>{var n,a,o,s,c,l,d,i,m,u,h;for(n=[],a=o=0,c=r.length;o<c;a=++o){for(h=r[a],u=0,a=s=0,l=(i=Object.keys(e)).length;s<l;a=++s)m=i[a],d=Math.abs(e[m]-h.stats[m]),u+=t[a]*Math.pow(d/100,3);n.push({name:h.name,score:u/t.length})}return n.sort(((e,t)=>e.score-t.score))},d=e=>Object.keys(e).length===M.length&&(!Object.values(e).some((e=>void 0===e))&&!!Object.values(e).every((e=>e>=0&&e<=100))),M=["spos","alle","expr","pers","horn","fame","shwr","sani","rela","fedp","actn","purp","perc","cmdy"],O=(S=new URLSearchParams(document.location.search)).get("score"),n=S.get("edition"),I=O.split(",").reduce(((e,t,r)=>({...e,[M[r]]:parseFloat(t)})),{}),document.getElementById("submit-button").addEventListener("click",(()=>R?location.href="submitter.html?score="+Object.values(I).map((e=>e.toFixed(1))).join(","):alert(o))),!d(I))throw R=!1,o="Invalid scores",alert(o),Error(o);for(V=Array(14).fill(2),T=await H("values"),C=w(I,V,await H("users")),document.getElementById("cmatch").textContent=C[0].name+": "+(100*(1-C[0].score)).toFixed(1)+"%",b=document.getElementById("other-matches"),c=i=1;i<=5;c=++i)(e=>{var t;(t=document.createElement("p")).textContent=C[e].name+": "+(100*(1-C[e].score)).toFixed(1)+"%",b.appendChild(t)})(c);for(y={edition:"s"===n?"Short test":"Full test",user:C[0].name,version:window.VERSION},r=document.getElementById("banner"),[e,s]=window.matchMedia("(prefers-color-scheme: dark)").matches?["#333","#EEE"]:["#EEE","#333"],t=new A(r,1860,800,s,e),l=m=0,h=T.length;m<h;l=++m)for(L=T[l],t.drawValues(L,l),t.drawValueBg(l),a=document.getElementById(L.name+"-label"),B=Object.keys(I)[l],x=I[B],a.textContent=L.tiers[A.findTier(x)],f=L.labels,l=u=0,E=f.length;u<E;l=++u)F(f[l],l?100-x:x);for(l=g=0,p=(j=Object.keys(I)).length;g<p;l=++g)k=j[l],t.drawScoreRect(I,T,k,l);v=()=>{var e,r,n;if(R){for(l=r=0,e=(n=Object.keys(I)).length;r<e;l=++r)k=n[l],t.drawScoreLabel(I[k],T,l);return t.drawHeader(y)}},setTimeout((()=>{var e;return(e=document.createEvent("Event")).initEvent("load",!1,!1),window.dispatchEvent(e),v()}),300);
//# sourceMappingURL=results.js.map