{"version":3,"names":["answers","buttons","calc_scores","j","k","len","maxscores","next_question","q_n","questions","ref","ref1","render_question","scores","short","v","getJson","button","results","results1","document","getElementById","textContent","length","question","yesno","style","display","final_scores","i","Object","keys","push","toFixed","window","location","href","join","val","effect","search","filter","Array","Math","abs","stag","ag","neut","disag","stdisag","addEventListener","ref2","history","back"],"sources":["..\\/src\\quiz.coffee"],"sourcesContent":["import {getJson} from \"./common.js\"\r\n\r\nrender_question = ->\r\n    document.getElementById(\"question-number\").textContent = \"Question #{q_n + 1} of #{questions.length}\"\r\n    document.getElementById(\"question-text\").textContent = questions[q_n].question\r\n    if questions[q_n].yesno\r\n        for k,v of buttons\r\n            button = document.getElementById \"button-\" + k\r\n            switch v\r\n                when 1\r\n                    button.textContent = \"Yes\"\r\n                when -1\r\n                    button.textContent = \"No\"\r\n                else \r\n                    button.style.display = \"none\"\r\n    else\r\n        for k,v of buttons\r\n            button = document.getElementById \"button-\" + k\r\n            switch v\r\n                when 1\r\n                    button.textContent = \"Strongly Agree\"\r\n                when -1\r\n                    button.textContent = \"Strongly Disagree\"\r\n                else \r\n                    button.style.display = \"block\"\r\n\r\ncalc_scores = ->\r\n    final_scores = []\r\n\r\n    for v,i in Object.keys(scores)\r\n        final_scores.push (100*(maxscores[v]+scores[v])/(2*maxscores[v])).toFixed(1)\r\n\r\n    window.location.href = \"results.html?\" + \"score=\" + \\\r\n    final_scores.join(\",\") + \"&edition=\" + \\\r\n    if short then \"s\" else \"f\"\r\n\r\nnext_question = (val) ->\r\n    answers[q_n] = val\r\n    for k,v of questions[q_n].effect\r\n        scores[k] += v*val\r\n    q_n++\r\n    if q_n >= questions.length\r\n        do calc_scores\r\n    else\r\n        do render_question\r\n\r\nshort = document.location.search is \"?s\"\r\nquestions = await getJson \"questions\"\r\nif short\r\n    questions = questions.filter( (question) ->\r\n        question.short\r\n    )\r\n\r\nanswers = new Array questions.length\r\n\r\nmaxscores = {}\r\nscores = {}\r\nq_n = 0\r\n\r\nfor k,v of questions[0].effect\r\n    scores[k] = 0 \r\n    maxscores[k] = 0\r\n\r\nfor question in questions\r\n    for k,v of question.effect\r\n        maxscores[k] += Math.abs v\r\n\r\nbuttons = \r\n    stag : 1.0\r\n    ag : 0.5\r\n    neut : 0\r\n    disag : -0.5\r\n    stdisag : -1\r\n\r\nfor k,v of buttons\r\n    do(k,v) ->\r\n        obj = document.getElementById \"button-\" + k\r\n        obj.addEventListener \"click\", () -> next_question v\r\n\r\ndocument.getElementById(\"back_button\").addEventListener \"click\", () ->\r\n    if q_n is 0\r\n        do window.history.back\r\n    else\r\n        q_n--\r\n        for k,v of questions[q_n].effect\r\n            scores[k] -= answers[q_n]*v\r\n        do render_question\r\n\r\ndo render_question"],"mappings":"AAAA,IAAAA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,oBAAQC,MAAR,cA2DA,IAAAZ,KAzDAQ,EAAkB,KAClB,IAAAK,EAAAb,EAAAc,EAAAC,EAAAJ,EAEI,GAFAK,SAASC,eAAe,mBAAmBC,YAAc,YAAYd,EAAM,QAAQC,EAAUc,SAC7FH,SAASC,eAAe,iBAAiBC,YAAcb,EAAUD,GAAKgB,SACnEf,EAAUD,GAAKiB,MAAlB,CACI,IAAArB,KAAAc,EAAA,GAAAjB,EAEI,O,OADAgB,EAASG,SAASC,eAAe,UAAYjB,GACtCW,GAAP,KACS,E,OACDE,EAAOK,YAAc,OADpB,MADT,KAGU,E,OACFL,EAAOK,YAAc,MADpB,MAHT,Q,OAMQL,EAAOS,MAAMC,QAAU,Q,SAEnC,IAAAvB,KAAAe,EAAA,GAAAlB,EAEI,O,OADAgB,EAASG,SAASC,eAAe,UAAYjB,GACtCW,GAAP,KACS,E,OACDE,EAAOK,YAAc,kBADpB,MADT,KAGU,E,OACFL,EAAOK,YAAc,qBADpB,MAHT,Q,OAMQL,EAAOS,MAAMC,QAAU,S,QAtBzB,EAwBlBzB,EAAc,KACd,IAAA0B,EAAAC,EAAA1B,EAAAE,EAAAK,EAAAK,EAEI,IAFAa,EAAe,GAEfC,EAAA1B,EAAA,EAAAE,GAAAK,EAAAoB,OAAAC,KAAAlB,IAAAU,OAAApB,EAAAE,EAAAwB,IAAA1B,E,OACIyB,EAAaI,MAAM,KAAK1B,EAAUS,GAAGF,EAAOE,KAAK,EAAET,EAAUS,KAAKkB,QAAQ,I,OAE9EC,OAAOC,SAASC,KAAO,sBACvBR,EAAaS,KAAK,KAAO,aACtBvB,EAAW,IAAS,IARb,EAUdP,EAAiB+B,IACjB,IAAAlC,EAAAM,EAAAK,EACI,IAAAX,KADAJ,EAAQQ,GAAO8B,EACf5B,EAAAD,EAAAD,GAAA+B,O,OACI1B,EAAOT,IAAMW,EAAEuB,EAEnB,QADA9B,GACUC,EAAUc,OACbrB,IAEAU,GARK,EAUhBE,EAAoC,OAA5BM,SAASe,SAASK,OAC1B/B,QAAkBO,EAAQ,aACvBF,IACCL,EAAYA,EAAUgC,QAASjB,GAC3BA,EAASV,SAGjBd,EAAc0C,MAAMjC,EAAUc,QAE9BjB,EAAY,GACZO,EAAS,GACTL,EAAM,EAENE,EAAAD,EAAA,GAAA8B,O,OACI1B,EAAOT,GAAK,EACZE,EAAUF,GAAK,EAEnB,IAAAD,EAAA,EAAAE,EAAAI,EAAAc,OAAApB,EAAAE,EAAAF,IACI,IAAAC,KAAAO,E,KAAA4B,O,OACIjC,EAAUF,IAAMuC,KAAKC,IAAI7B,GASjC,IAAAX,KAPAH,EACI,CAAA4C,KAAO,EACPC,GAAK,GACLC,KAAO,EACPC,OAAS,GACTC,SAAW,G,OAGT,EAAC7C,EAAEW,KACKK,SAASC,eAAe,UAAYjB,GACtC8C,iBAAiB,SAAS,IAAM3C,EAAcQ,IAFpD,GAACX,EAAEW,GAITK,SAASC,eAAe,eAAe6B,iBAAiB,SAAS,KACjE,IAAAC,EAAI,GAAU,IAAP3C,E,OACI0B,OAAOkB,QAAQC,OAGlB,IAAAjD,KADAI,IACA2C,EAAA1C,EAAAD,GAAA+B,O,OACI1B,EAAOT,IAAMJ,EAAQQ,GAAKO,E,OAC3BH,GAPsD,IAS9DA"}